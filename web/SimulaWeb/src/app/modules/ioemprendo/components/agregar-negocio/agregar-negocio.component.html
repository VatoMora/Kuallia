<div class="container-fluid p-4">
  <!-- Contenido principal -->
  <main id="main-content" role="main" aria-labelledby="page-title">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card shadow">
          <div class="card-header bg-primary text-white">
            <h1 id="page-title" class="mb-0 h4">
              <i class="fas fa-plus-circle me-2" aria-hidden="true"></i>
              Agregar Nuevo Negocio
            </h1>
          </div>
        
          <div class="card-body">
          <!-- Mensaje de error -->
          <div *ngIf="error" class="alert alert-danger" role="alert">
            <i class="fas fa-exclamation-triangle me-2"></i>
            {{ error }}
          </div>

          <form [formGroup]="negocioForm" (ngSubmit)="onSubmit()" novalidate>
            <fieldset>
              <legend class="visually-hidden">Información del negocio</legend>
              <div class="row">
                <!-- Nombre del negocio -->
                <div class="col-md-6 mb-3">
                  <label for="nombre" class="form-label">
                    <i class="fas fa-store me-2" aria-hidden="true"></i>
                    Nombre del Negocio *
                  </label>
                  <input 
                    type="text" 
                    class="form-control" 
                    id="nombre" 
                    formControlName="nombre"
                    [class.is-invalid]="isFieldInvalid('nombre')"
                    [attr.aria-describedby]="isFieldInvalid('nombre') ? 'nombre-error' : null"
                    placeholder="Ej: Mi Tienda de Ropa"
                    required
                    aria-required="true">
                  <div id="nombre-error" class="invalid-feedback" *ngIf="isFieldInvalid('nombre')" role="alert">
                    {{ getFieldError('nombre') }}
                  </div>
                </div>

                <!-- Giro del negocio -->
                <div class="col-md-6 mb-3">
                  <label for="giro" class="form-label">
                    <i class="fas fa-industry me-2" aria-hidden="true"></i>
                    Giro del Negocio *
                  </label>
                  <input 
                    type="text" 
                    class="form-control" 
                    id="giro" 
                    formControlName="giro"
                    [class.is-invalid]="isFieldInvalid('giro')"
                    [attr.aria-describedby]="isFieldInvalid('giro') ? 'giro-error' : null"
                    placeholder="Ej: Ropa y Accesorios"
                    required
                    aria-required="true">
                  <div id="giro-error" class="invalid-feedback" *ngIf="isFieldInvalid('giro')" role="alert">
                    {{ getFieldError('giro') }}
                  </div>
                </div>

                <!-- Foto del negocio -->
                <div class="col-12 mb-3">
                  <label for="foto" class="form-label">
                    <i class="fas fa-camera me-2" aria-hidden="true"></i>
                    Foto del Negocio
                  </label>
                  <input 
                    type="file" 
                    class="form-control" 
                    id="foto" 
                    accept="image/*"
                    (change)="onFileSelected($event)"
                    aria-describedby="foto-help">
                  <div id="foto-help" class="form-text">
                    Formatos permitidos: JPG, PNG, GIF. Tamaño máximo: 5MB.
                  </div>
                </div>

                <!-- Preview de la imagen -->
                <div class="col-12 mb-3" *ngIf="imagePreview">
                  <label class="form-label">Vista previa:</label>
                  <div class="text-center">
                    <img [src]="imagePreview" 
                         alt="Vista previa de la imagen del negocio"
                         class="img-thumbnail" 
                         style="max-width: 300px; max-height: 200px;">
                  </div>
                </div>
              </div>
            </fieldset>

            <!-- Botones -->
            <div class="row">
              <div class="col-12">
                <div class="d-flex justify-content-end gap-2" role="group" aria-label="Acciones del formulario">
                  <button 
                    type="button" 
                    class="btn btn-secondary"
                    (click)="cancelar()"
                    [disabled]="loading"
                    aria-label="Cancelar la creación del negocio">
                    <i class="fas fa-times me-2" aria-hidden="true"></i>
                    Cancelar
                  </button>
                  <button 
                    type="submit" 
                    class="btn btn-primary"
                    [disabled]="loading"
                    [attr.aria-label]="loading ? 'Guardando negocio, por favor espere' : 'Guardar nuevo negocio'">
                    <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                    <i *ngIf="!loading" class="fas fa-save me-2" aria-hidden="true"></i>
                    {{ loading ? 'Guardando...' : 'Guardar Negocio' }}
                  </button>
                </div>
              </div>
            </div>
          </form>
          </div>
        </div>
      </div>

      <!-- Información adicional -->
      <div class="col-lg-8">
        <aside class="card mt-4 border-info" aria-labelledby="info-title">
          <div class="card-header bg-info text-white">
            <h2 id="info-title" class="mb-0 h5">
              <i class="fas fa-info-circle me-2" aria-hidden="true"></i>
              Información Importante
            </h2>
          </div>
          <div class="card-body">
            <ul class="list-unstyled mb-0">
              <li class="mb-2">
                <i class="fas fa-check-circle text-success me-2" aria-hidden="true"></i>
                El nombre del negocio debe ser único para tu usuario.
              </li>
              <li class="mb-2">
                <i class="fas fa-check-circle text-success me-2" aria-hidden="true"></i>
                Puedes agregar productos después de crear el negocio.
              </li>
              <li class="mb-2">
                <i class="fas fa-check-circle text-success me-2" aria-hidden="true"></i>
                La foto es opcional pero recomendada para una mejor experiencia.
              </li>
              <li class="mb-0">
                <i class="fas fa-check-circle text-success me-2" aria-hidden="true"></i>
                Una vez creado, podrás simular el rendimiento de tu negocio.
              </li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
  </main>
</div>
